---
title: Simulation (4):system identification
date: 2023-05-09 15:33:00 +0900
categories: [System Identification]
tags: [System Identification, Contol]
author: <author_id>
math: true
---

# 3.5.1 同定対象
2次のシステムを考える．

$$
\begin{aligned}
x_{t} &=-a_1x_{t-1}-a_2x_{t-2}+b_1u_{t-1}+b_2u_{t-2}  \\
y_t &=x_t+v_t 
\end{aligned}
$$

ただし，

$$
a_1=-1.5,\quad a_2=0.7,\quad b_1=1.0, \quad b_2=0.5
$$

ここで，入力信号を $[0,1]$ の範囲で**一様分布する乱数**とする．観測雑音は**ゼロ平均**のガウス分布乱数で，**入力信号と無相関**である．
 雑音のレベルは一般に雑音信号比（Noise Signal Ratio, $NSR$ ）で評価される．ここで, **$NSR$ は雑音 $v_t$ の標準偏差と真の出力信号 $x_t$ の標準偏差との比である.** 

# 3.5.2 逐次最小二乗法によるパラメータ推定
同じ入力信号に対して，出力の雑音信号比 $NSR$ をそれぞれ **0%，10%，20%** とし，入出力信号の観測値 $\{u_t , y_t\}(t = 1, 2, · · · , N)$ を用いて，パラメータを逐次最小二乗法で推定せよ。ただし，$N$ は**十分大きな整数（2000 ∼ 3000**）とする。時刻を横軸として，各推定パラメータの挙動を，パラメータの真値とあわせて図示せよ。観測雑音によるパラメータ 推定値への影響を考察せよ。

$$
y_t=-a_1y_{t-1}-a_2y_{t-2}+b_1u_{t-1}+b_2u_{t-2}+r_t
$$

$$
z_t^T=[-y_{t-1},-y_{t-2},u_{t-1},u_{t-2}]
$$

$$
\theta^T=[a_1,a_2,b_1,b_2]
$$

[[3.線形システムのパラメータ推定#3.3 **逐次最小二乗法**]]

> 行列計算のところに注意すべき

考察：
出力の雑音信号比(雑音のレベル)が大きいほど，逐次最小二乗法によるパラメータの推定値は，パラメータの真値とずれが生じる．

# 3.5.3 逐次最小二乗法による時変系のパラメータ推定
2次の時変システム：

$$\begin{aligned}
&x_t {=}{-a_{1,t}x_{t-1}-a_{2,t}x_{t-2}+b_{1,t}u_{t-1}+b_{2,t}u_{t-2}}  \\
&y_t =x_t+v_t 
\end{aligned}$$

ただし，係数：

$$\begin{aligned}
a_{1,t}&= -1.0+0.5\sin(2\pi t/2000)  \\
a_{2,t}& =0.7  \\
b_{1,t}& =1.0  \\
b_{2,t}& =0.5+0.4\cos(2\pi t/2000) 
\end{aligned}$$

同じ入力信号に対して，出力の雑音信号比 $NSR$ をそれぞれ **0%，5%，10%** とした場合， 逐次最小二乗法で上記のシステムの時変パラメータを推定せよ。時刻を横軸として，各推定パラメータの挙動を，パラメータの真値とあわせて図示せよ。忘却係数及び観測雑音によるパラメータ推定値への影響を考察せよ。

考察：雑音のレベルが逐次最小二乗法による時変系のパラメータ推定への影響

# 3.5.4 逐次補助変数法によるパラメータ推定
